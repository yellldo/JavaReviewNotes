## 分布式主键

> 市面上的分布式主键都是基于雪花算法改造的，实际上雪花算法只是提供了一个规范。
>
> 美团Leaf 、阿里TDDL

### 雪花算法

> 雪花算法是由1位固定值0因为id是正整，如果为1就是负数，
>
> 41位毫秒级时间戳，2^41/(1000*60*60*24*365)=69，大概可以使用 69 年
>
> 5位datacenterId和5为workerId，最多可以部署 2^10=1024 台机器。
>
> 12位序号：同一毫秒时间戳时，通过递增序号区分，即对于同一台机器而言，同一毫秒时间戳下，可以生成2^12=4096 个不重复 id。

缺点：强依赖机器时钟，如果机器上时钟回拨，会导致发号重复或者服务会处于不可用状态。