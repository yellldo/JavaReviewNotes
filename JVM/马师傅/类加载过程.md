# 类加载

## 加载过程

- 加载
  > 1. 双亲委派，主要出于安全考虑
  > 2. LazyLoading 五种情况  
       1. new getstatic pubstatic invokestatic指令，访问final变量除外  
       2. java.lang.reflect对类进行反射调用时  
       3. 初始化子类时，父类首先初始化  
       4. 虚拟机启动时，被执行的主类必须初始化  
       5. 动态语言支持java.lang.invoke.MethodHandler
    3. ClassLoader源码
        1. findInCache -> parent.loadClass -> findClass
    4. 自定义类加载器
        1. extends ClassLoader
        2. 重写findClass() -> defineClass
        3. 加密
    5. 混合执行 编译执行 解释执行

- 连接
    - 验证

      > 校验文件是否符合JVM规定
    - 准备

      > 静态成员变量赋默认值
    - 解析

      > 将类、方法、属性等符号引用解析为直接引用  
      常量池中的各种符号引用解析为指针、偏移量等内存地址的直接引用

- 初始化

  > 调用类初始化代码，给静态成员变量赋初始值

## 类加载过程

![类加载过程.png](类加载过程.png)